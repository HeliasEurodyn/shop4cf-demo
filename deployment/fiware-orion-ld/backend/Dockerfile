FROM adoptopenjdk/openjdk11:jre11u-centos-nightly

EXPOSE 20000

ARG JAR_FILE=camunda-project-1.0.0.jar
ADD ${JAR_FILE} app.jar

ARG CAMUNDA_USER
ARG CAMUNDA_PASSWORD
ARG FIWARE_URL
ARG POSTGRE_URL
ARG POSTGRE_DBNAME
ARG POSTGRE_USER
ARG POSTGRE_PASSWORD

ENV CAMUNDA_USER_ENV=${CAMUNDA_USER}
ENV CAMUNDA_PASSWORD_ENV=${CAMUNDA_PASSWORD}
ENV FIWARE_URL_ENV=${FIWARE_URL}
ENV POSTGRE_URL_ENV=${POSTGRE_URL}
ENV POSTGRE_DBNAME_ENV=${POSTGRE_DBNAME}
ENV POSTGRE_USER_ENV=${POSTGRE_USER}
ENV POSTGRE_PASSWORD_ENV=${POSTGRE_PASSWORD}

RUN touch ./entrypoint.sh
RUN echo "java -jar ./app.jar --camundaUser=${CAMUNDA_USER_ENV} --camundaPassword=${CAMUNDA_PASSWORD_ENV} --fiwareurl=${FIWARE_URL_ENV} --postgreUrl=${POSTGRE_URL_ENV} --postgreDbName=${POSTGRE_DBNAME_ENV} --postgreUser=${POSTGRE_USER_ENV} --postgrePassword=${POSTGRE_PASSWORD_ENV} " > ./entrypoint.sh
RUN chmod +x ./entrypoint.sh
CMD ./entrypoint.sh